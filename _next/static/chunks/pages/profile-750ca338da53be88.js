(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[277],{9813:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile",function(){return s(8370)}])},3362:function(e,t,s){"use strict";s.r(t);var i=s(5893),n=s(5013),l=s.n(n),r=s(7039),o=s(3299),a=s(5434),c=s(9583);t.default=()=>{let{t:e}=(0,r.$G)(),t=(0,o.useSession)();return(0,i.jsx)(i.Fragment,{children:"authenticated"==t.status&&(0,i.jsxs)("div",{className:l().logOutRow,children:[(0,i.jsxs)("button",{children:[(0,i.jsx)(c.qau,{}),(0,i.jsx)("div",{children:e("buttons.change_password")})]}),(0,i.jsxs)("button",{onClick:()=>{(0,o.signOut)({callbackUrl:"/profile",redirect:!1})},children:[(0,i.jsx)(a.LvP,{}),(0,i.jsx)("div",{children:e("buttons.logout")})]})]})})}},5986:function(e,t,s){"use strict";s.r(t);var i=s(5893),n=s(7294),l=s(9993),r=s.n(l),o=s(7786),a=s(7039),c=s(9327),d=s(2585);t.default=e=>{let{t}=(0,a.$G)(),[s,l]=(0,n.useState)(e.name),[u,p]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{l(e.name)},[e.name]),(0,i.jsx)(i.Fragment,{children:u?(0,i.jsxs)("div",{className:r().loginRow,children:[(0,i.jsxs)("div",{className:r().profile_data,children:[(0,i.jsx)("input",{type:"text",value:s,onChange:e=>{l(e.target.value)}}),(0,i.jsxs)("div",{className:r().userEmail,children:[(0,i.jsx)("div",{className:"nbl-icon nbl-icon_email_16"}),(0,i.jsx)("div",{children:e.email})]})]}),(0,i.jsxs)(o.z,{type:"editLoginButton",color:"purple",onClick:()=>{p(!1)},children:[(0,i.jsx)(d.saV,{}),t("buttons.save")]})]}):(0,i.jsxs)("div",{className:r().loginRow,children:[(0,i.jsxs)("div",{className:r().profile_data,children:[(0,i.jsx)("div",{className:r().userName,children:s}),(0,i.jsxs)("div",{className:r().userEmail,children:[(0,i.jsx)("div",{className:"nbl-icon nbl-icon_email_16"}),(0,i.jsx)("div",{children:e.email})]})]}),(0,i.jsxs)(o.z,{type:"editLoginButton",color:"purple",onClick:()=>{p(!0)},children:[(0,i.jsx)(c.EoG,{}),t("buttons.edit_profile")]})]})})}},8370:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return J}});var i=s(5893),n=s(7294),l=s(9008),r=s.n(l),o=s(6433),a=s.n(o),c=s(7786),d=s(7039),u=s(1664),p=s.n(u),_=s(755),h=s.n(_),f=s(7106),v=s(5675),x=s.n(v),g={src:"/IVI/_next/static/media/present.9af5ac67.png",height:64,width:110,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAYAAAB4ka1VAAAAmUlEQVR42mMAgdMKdswMUPD//3+XPx+/nLhlF6HKAAIv2SwtQPTr6Cyx4wwMto/aJ+x/0Tv9/+vl6z/9/fW3juEaq3H3cXXr+OcM1g2P5izddj+78v8JBoYvD6rb/n95/OwKAwhsMXPV92dg4H7387fDy6XrXj6vavv/MLviz/7UfBOG//wFjAyoQPjFzv3bHs9aspCBgYEBALJrQ5+Vb/R9AAAAAElFTkSuQmCC",blurWidth:8,blurHeight:5},j={src:"/IVI/_next/static/media/settings.badd7d2a.svg",height:32,width:32,blurWidth:0,blurHeight:0},m={src:"/IVI/_next/static/media/payment.07e45efd.svg",height:32,width:32,blurWidth:0,blurHeight:0},w={src:"/IVI/_next/static/media/favorite.3dbaeae2.svg",height:32,width:32,blurWidth:0,blurHeight:0},b={src:"/IVI/_next/static/media/history.d5e5c362.svg",height:32,width:32,blurWidth:0,blurHeight:0},N={src:"/IVI/_next/static/media/code.ac067cf4.svg",height:32,width:32,blurWidth:0,blurHeight:0},B={src:"/IVI/_next/static/media/support.9f9db344.svg",height:32,width:32,blurWidth:0,blurHeight:0},S={src:"/IVI/_next/static/media/card.77e675a7.svg",height:32,width:32,blurWidth:0,blurHeight:0};let k=()=>{let{t:e}=(0,d.$G)();return(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:h().topBtnRow,children:[(0,i.jsx)(p(),{href:"https://www.ivi.ru/profile/subscriptions",className:h().subscribeBtn,children:(0,i.jsxs)(c.z,{color:"purple",type:"profileSertButton",children:[(0,i.jsx)("div",{children:e("profile.subscribes")}),(0,i.jsx)("div",{children:e("profile.go_connection")})]})}),(0,i.jsx)(p(),{href:"https://www.ivi.ru/profile",className:h().sertBtn,children:(0,i.jsxs)(c.z,{color:"purple",type:"profileSertButton",children:[(0,i.jsx)("div",{children:e("profile.certificates")}),(0,i.jsx)("div",{children:e("profile.activate")})]})}),(0,i.jsxs)(c.z,{color:"purple",type:"profileSertButton",className:h().accountBtn,children:[(0,i.jsx)("div",{children:e("profile.account")}),(0,i.jsx)("div",{children:"0 ₽"})]})]}),(0,i.jsx)("div",{className:h().subscribePresentBtn,children:(0,i.jsx)(p(),{href:"https://widget.mgc-loyalty.ru/iviru/landing",children:(0,i.jsxs)(c.z,{type:"profilePresentButton",children:[(0,i.jsx)(x(),{src:g,alt:"presentButton",priority:!0}),(0,i.jsx)("div",{children:e("profile.give_subscription")})]})})}),(0,i.jsxs)("div",{className:h().inviteBtnRow,children:[(0,i.jsx)(p(),{href:"https://www.ivi.ru/profile/referral",children:(0,i.jsxs)(c.z,{type:"profileInviteButton",color:"purple",children:[(0,i.jsx)("div",{children:(0,i.jsx)(f.FUn,{})}),(0,i.jsx)("div",{children:e("profile.invite")})]})}),(0,i.jsx)(p(),{href:"https://www.ivi.ru/profile/pull_notifications",children:(0,i.jsxs)(c.z,{type:"profileInviteButton",color:"purple",children:[(0,i.jsx)("div",{children:(0,i.jsx)(f.kwp,{})}),(0,i.jsx)("div",{children:e("profile.notifications")})]})})]}),(0,i.jsxs)("div",{className:h().bottomBtnRow,children:[(0,i.jsx)(p(),{href:"https://www.ivi.ru/profile/purchases",children:(0,i.jsxs)(c.z,{color:"purple",type:"profileMenuButton",children:[(0,i.jsx)(x(),{src:m,alt:"payment"}),(0,i.jsx)("div",{children:e("profile.purchases")})]})}),(0,i.jsx)(p(),{href:"https://www.ivi.ru/profile/favorites",children:(0,i.jsxs)(c.z,{color:"purple",type:"profileMenuButton",children:[(0,i.jsx)(x(),{src:w,alt:"favorite"}),(0,i.jsx)("div",{children:e("profile.watch_later")})]})}),(0,i.jsx)(p(),{href:"https://www.ivi.ru/profile/watched",children:(0,i.jsxs)(c.z,{color:"purple",type:"profileMenuButton",children:[(0,i.jsx)(x(),{src:b,alt:"history"}),(0,i.jsx)("div",{children:e("profile.views")})]})}),(0,i.jsx)(p(),{href:"https://www.ivi.ru/profile/cards",children:(0,i.jsxs)(c.z,{color:"purple",type:"profileMenuButton",children:[(0,i.jsx)(x(),{src:S,alt:"card"}),(0,i.jsx)("div",{children:e("profile.payment")})]})}),(0,i.jsx)(p(),{href:"https://www.ivi.ru/profile",children:(0,i.jsxs)(c.z,{color:"purple",type:"profileMenuButton",children:[(0,i.jsx)(x(),{src:N,alt:"code"}),(0,i.jsx)("div",{children:e("profile.login_by_code")})]})}),(0,i.jsx)(p(),{href:"https://www.ivi.ru/profile/settings",children:(0,i.jsxs)(c.z,{color:"purple",type:"profileMenuButton",children:[(0,i.jsx)(x(),{src:j,alt:"settings"}),(0,i.jsx)("div",{children:e("profile.settings")})]})}),(0,i.jsx)(p(),{href:"https://ask.ivi.ru/?_gl=1*1gchsbl*_ga*MjcwMjg3NzUzLjE2ODM1MjkwODI.*_ga_GETQ4387MJ*MTY4MzY4OTYyMC4zLjEuMTY4MzcxMzk5OS4xMC4wLjA.",children:(0,i.jsxs)(c.z,{color:"purple",type:"profileMenuButton",children:[(0,i.jsx)(x(),{src:B,alt:"support"}),(0,i.jsx)("div",{children:e("profile.help")})]})})]})]})};var y=s(5986),M=s(3362),I=s(2237),R=s.n(I),A=s(3299),z=s(2539),C=s.n(z),E=s(4469),P=s.n(E),O=()=>{let{t:e}=(0,d.$G)();return(0,i.jsxs)("div",{className:P().continue_policy,children:[(0,i.jsx)("div",{children:e("profile.clicking")}),(0,i.jsxs)("div",{children:["с"," ",(0,i.jsx)(p(),{href:"https://www.ivi.ru/info/confidential",children:e("profile.to_policy")})]}),(0,i.jsxs)("div",{children:["и"," ",(0,i.jsx)(p(),{href:"https://www.ivi.ru/info/agreement",children:e("profile.user_agreement")})]})]})},G=s(1194),D=s.n(G),T=()=>(0,i.jsxs)("div",{onClick:()=>(0,A.signIn)("google"),className:D().google_button,children:[(0,i.jsx)("img",{loading:"lazy",height:"24",width:"24",id:"provider-logo-dark",src:"https://authjs.dev/img/providers/google.svg"}),(0,i.jsx)("span",{children:"Sign in with Google"})]}),U=e=>{let t=(0,n.useRef)(null),s=(0,n.useRef)(null),[l,r]=(0,n.useState)(e.inputData),{t:o}=(0,d.$G)(),a=e=>{r(e.target.value)},u=(0,A.useSession)();return console.log(u),(0,i.jsxs)("div",{className:C().content,children:[(0,i.jsxs)("div",{className:C().message,children:[(0,i.jsx)("div",{className:C().subtitle,children:o(e.content[e.step][0])}),(0,i.jsx)("span",{children:o("profile.least_characters")})]}),(0,i.jsxs)("div",{className:C().enter_data,children:[(0,i.jsx)("div",{className:C().input_div,onFocus:()=>{var e,i;null===(e=t.current)||void 0===e||e.focus(),null===(i=s.current)||void 0===i||i.classList.add("".concat(C().active))},onBlur:()=>{var e;null===(e=s.current)||void 0===e||e.classList.remove("".concat(C().active))},children:(0,i.jsx)("input",{className:C().enter_login,type:"text",ref:t,value:l,onChange:e=>a(e),placeholder:o(e.content[e.step][1])})}),(0,i.jsx)("div",{className:C().continue,children:(0,i.jsx)(c.z,{className:"".concat(C().continue_btn," ").concat(C().activeContinue," "),color:"pink",onClick:()=>{0!==l.length&&(e.setStep(e.step+1),e.setInputData(l),r(""))},children:o("buttons.continue")})}),(0,i.jsx)(T,{}),(0,i.jsx)(O,{})]})]})},V=s(1649);let L=e=>e.authData,F=e=>e.registrationData;var H=e=>{let{t}=(0,d.$G)(),[s,l]=(0,n.useState)(""),[r,o]=(0,n.useState)(),[a,u]=(0,n.useState)(),p=(0,V.v9)(L),_=(0,V.v9)(F),h=(0,A.useSession)();return(0,n.useEffect)(()=>{o(localStorage.getItem("email")),u(localStorage.getItem("nickname")),l("")},[]),(0,n.useEffect)(()=>{"authenticated"==h.status?l("profile.success_auth"):""!==localStorage.getItem("email")&&""!==localStorage.getItem("nickname")?(l("profile.success_regist"),u(localStorage.getItem("nickname"))):""===localStorage.getItem("email")&&""===localStorage.getItem("nickname")&&l("profile.error_auth")},[p,_,h]),(0,n.useEffect)(()=>{!1===e.openModal&&l("")},[e.openModal]),(0,i.jsxs)("div",{className:C().content,children:[(0,i.jsx)("div",{className:C().message,children:(0,i.jsx)("div",{className:C().subtitle,children:t(s)})}),(0,i.jsxs)("div",{className:C().enter_data,children:[(0,i.jsx)("div",{className:C().continue,children:"authenticated"===h.status?(0,i.jsx)(c.z,{className:"".concat(C().continue_btn," ").concat(C().activeContinue," "),color:"pink",onClick:()=>{e.setOpenModal(!1),e.setIsRegistration(!1)},children:t("buttons.continue")}):(0,i.jsxs)("div",{children:[(0,i.jsx)(c.z,{className:"".concat(C().continue_btn," ").concat(C().activeContinue," "),color:"pink",onClick:()=>e.setIsRegistration(!0),children:t("buttons.register")}),(0,i.jsx)(c.z,{className:"".concat(C().continue_btn," ").concat(C().activeContinue," "),color:"pink",onClick:()=>e.setIsAuthorization(!0),children:t("buttons.enter")})]})}),(0,i.jsx)(O,{})]})]})},X=s(6154);X.Z.defaults.baseURL="http://127.0.0.1:3000/api";let W=X.Z.create({withCredentials:!0,baseURL:"http://127.0.0.1:3000/api"}),K=(e,t,s)=>W.post("/users",{email:t,name:e,password:s,role:"user"});var Y=s(2994);let Q=e=>({type:Y.B.GET_REGISTRATION_DATA_SUCCESS,payload:e}),q=()=>({type:Y.B.GET_REGISTRATION_DATA_FAIL});var $=e=>{let{openModal:t,setOpenModal:s}=e,{t:l}=(0,d.$G)(),r={0:["profile.enter_email","profile.email"],1:["profile.enter_nickname","profile.nickname"],2:["profile.enter_password_short","profile.password"]},[o,a]=(0,n.useState)(0),[c,u]=(0,n.useState)("");(0,A.useSession)();let[p,_]=(0,n.useState)(!1),[h,f]=(0,n.useState)(!1),[v,x]=(0,n.useState)(!1),[g,j]=(0,n.useState)({nickName:"",login:"",password:""}),[m,w]=(0,n.useState)(2),[b,N]=(0,n.useState)({0:["profile.enter_or_regist","profile.by_email"],1:["profile.enter_password","profile.password"]}),[B,S]=(0,n.useState)(!1),k=(0,V.I0)(),y=async()=>{await (0,A.signIn)("credentials",{email:g.login,password:g.password,redirect:!1})},M=async()=>{S(!0);try{let e=await K(g.nickName,g.login,g.password);k(Q(e.data.user))}catch(e){k(q()),console.log("registration",e)}};return(0,n.useEffect)(()=>{v&&(f(!1),a(0))},[v]),(0,n.useEffect)(()=>{h?1===o?j({nickName:"",login:c,password:""}):2===o?j({nickName:c,login:null==g?void 0:g.login,password:""}):3===o&&j({nickName:g.nickName,login:null==g?void 0:g.login,password:c}):1===o?(j({nickName:"",login:c,password:""}),u("")):2===o&&(j({nickName:"",login:null==g?void 0:g.login,password:c}),u(""),x(!1))},[o]),(0,n.useEffect)(()=>{""===g.nickName&&""!==g.password?y():""!==g.nickName&&""!==g.login&&""!==g.password&&M()},[g]),(0,n.useEffect)(()=>{h&&(j({nickName:"",login:"",password:""}),a(0),w(3),N(r))},[h]),(0,i.jsxs)("div",{className:"".concat(R().profileModal," ").concat(t&&R().profileModal_open),children:[(0,i.jsxs)("div",{className:R().headerRow,children:[(0,i.jsx)("h1",{className:R().title,children:l("buttons.enter_or_regist")}),(0,i.jsx)("button",{className:R().closeBtn,onClick:()=>s(!1),children:(0,i.jsx)("div",{className:"nbl-icon nbl-icon_close_20 nbl-simpleControlButton__nbl-icon"})}),(0,i.jsx)("div",{className:R().bar,children:(0,i.jsx)("div",{className:R().bar_line,style:{width:"calc(33.33% * ".concat(o,")")}})})]}),o<m&&(0,i.jsx)(U,{step:o,setStep:a,inputData:c,setInputData:u,content:b}),o===m&&(0,i.jsx)(H,{openModal:t,setOpenModal:s,isRegistration:h,setIsRegistration:f,isAuthorization:v,setIsAuthorization:x,isNewAccout:B})]})},J=()=>{var e;let{t}=(0,d.$G)(),[s,l]=(0,n.useState)(!1),o=(0,A.useSession)();console.log("session",o);let u=async e=>{e.preventDefault(),l(!0)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r(),{children:(0,i.jsx)("title",{children:"Мой профиль"})}),s?(0,i.jsx)($,{openModal:s,setOpenModal:l}):(0,i.jsxs)("div",{className:a().profile,children:["authenticated"==o.status?(0,i.jsx)(y.default,{name:o.data.user.name,email:null===(e=o.data.user)||void 0===e?void 0:e.email}):(0,i.jsxs)(c.z,{type:"loginButton",color:"pink",className:a().loginBtn,onClick:u,children:[(0,i.jsx)("div",{className:"nbl-icon nbl-icon_avatar_16 nbl-button__nbl-icon"}),t("buttons.enter_register")]}),(0,i.jsx)(k,{}),(0,i.jsx)(M.default,{})]})]})}},1194:function(e){e.exports={google_button:"GoogleButton_google_button__c7cj8"}},755:function(e){e.exports={topBtnRow:"styles_topBtnRow__kls80",subscribeBtn:"styles_subscribeBtn__aeqWK",accountBtn:"styles_accountBtn__TwDct",subscribePresentBtn:"styles_subscribePresentBtn__3ESzY",inviteBtnRow:"styles_inviteBtnRow__bXjFg",bottomBtnRow:"styles_bottomBtnRow__XbqFH"}},4469:function(e){e.exports={continue_policy:"PolicyBlock_continue_policy__eomXR"}},2539:function(e){e.exports={content:"Steps_content__vGgtc",message:"Steps_message__VQxbF",subtitle:"Steps_subtitle__Lh6h1",enter_data:"Steps_enter_data__lDsbI",input_div:"Steps_input_div__p9JCt",enter_login:"Steps_enter_login__oS_v9",enter_password:"Steps_enter_password__Rq_ea",continue:"Steps_continue__7zddR",continue_btn:"Steps_continue_btn__vwm5y",activeContinue:"Steps_activeContinue__HEHKd",vk:"Steps_vk__ifaIA","example-appear":"Steps_example-appear__ugZWV","example-appear-active":"Steps_example-appear-active__Q5Aoa",appearence:"Steps_appearence__f9xvw"}},2237:function(e){e.exports={profileModal:"ProfileModal_profileModal__O73rM",profileModal_open:"ProfileModal_profileModal_open__01aU0",headerRow:"ProfileModal_headerRow__dvGvZ",content:"ProfileModal_content__XiGY_",title:"ProfileModal_title__Krqku",closeBtn:"ProfileModal_closeBtn__nWqKC",bar:"ProfileModal_bar__36PPx",bar_line:"ProfileModal_bar_line__v66IC",googleInput:"ProfileModal_googleInput__Q1pMf",vkInput:"ProfileModal_vkInput__CWwCU"}},5013:function(e){e.exports={logOutRow:"LogOut_logOutRow__3MyFT"}},9993:function(e){e.exports={loginRow:"UserName_loginRow__tXK_J",profile_data:"UserName_profile_data__ruttw",userName:"UserName_userName__geBvq",userEmail:"UserName_userEmail__fNuZ_"}},6433:function(e){e.exports={profile:"profile_profile__eF7Pb",loginRow:"profile_loginRow__pDV_r",userName:"profile_userName__DlC37",userEmail:"profile_userEmail__av_HP",loginBtn:"profile_loginBtn__h9U5K",topBtnRow:"profile_topBtnRow__gpn6B",subscribeBtn:"profile_subscribeBtn__Vjatr",accountBtn:"profile_accountBtn__TN0AX",subscribePresentBtn:"profile_subscribePresentBtn__AEDr5",inviteBtnRow:"profile_inviteBtnRow__5hIxo",bottomBtnRow:"profile_bottomBtnRow__XA7YO",logOutRow:"profile_logOutRow__zfk5R"}}},function(e){e.O(0,[980,90,237,774,888,179],function(){return e(e.s=9813)}),_N_E=e.O()}]);